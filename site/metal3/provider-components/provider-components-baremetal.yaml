apiVersion: v1
kind: Namespace
metadata:
  labels:
    control-plane: capbm-controller-manager
    controller-tools.k8s.io: "1.0"
  name: capbm-system
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  labels:
    control-plane: capbm-controller-manager
  name: baremetalclusters.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: BareMetalCluster
    plural: baremetalclusters
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: BareMetalCluster is the Schema for the baremetalclusters API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: BareMetalClusterSpec defines the desired state of BareMetalCluster.
          type: object
        status:
          description: BareMetalClusterStatus defines the observed state of BareMetalCluster.
          properties:
            apiEndpoints:
              description: APIEndpoints represents the endpoints to communicate with
                the control plane.
              items:
                description: APIEndpoint represents a reachable Kubernetes API endpoint.
                properties:
                  host:
                    description: Host is the hostname on which the API server is serving.
                    type: string
                  port:
                    description: Port is the port on which the API server is serving.
                    type: integer
                required:
                - host
                - port
                type: object
              type: array
            ready:
              description: Ready denotes that the baremetal cluster (infrastructure)
                is ready. In Baremetal case, it does not mean anything for now as
                no infrastructure steps need to be performed. Required by Cluster
                API. Set to True by the BaremetalCluster controller after creation.
              type: boolean
          required:
          - ready
          type: object
      type: object
  version: v1alpha2
  versions:
  - name: v1alpha2
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  labels:
    control-plane: capbm-controller-manager
  name: baremetalhosts.metal3.io
spec:
  additionalPrinterColumns:
  - JSONPath: .status.operationalStatus
    description: Operational status
    name: Status
    type: string
  - JSONPath: .status.provisioning.state
    description: Provisioning status
    name: Provisioning Status
    type: string
  - JSONPath: .spec.consumerRef.name
    description: Consumer using this host
    name: Consumer
    type: string
  - JSONPath: .spec.bmc.address
    description: Address of management controller
    name: BMC
    type: string
  - JSONPath: .status.hardwareProfile
    description: The type of hardware detected
    name: Hardware Profile
    type: string
  - JSONPath: .spec.online
    description: Whether the host is online or not
    name: Online
    type: string
  - JSONPath: .status.errorMessage
    description: Most recent error
    name: Error
    type: string
  group: metal3.io
  names:
    kind: BareMetalHost
    listKind: BareMetalHostList
    plural: baremetalhosts
    shortNames:
    - bmh
    - bmhost
    singular: baremetalhost
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: BareMetalHost is the Schema for the baremetalhosts API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: BareMetalHostSpec defines the desired state of BareMetalHost
          properties:
            bmc:
              description: How do we connect to the BMC?
              properties:
                address:
                  description: Address holds the URL for accessing the controller
                    on the network.
                  type: string
                credentialsName:
                  description: The name of the secret containing the BMC credentials
                    (requires keys "username" and "password").
                  type: string
              required:
              - address
              - credentialsName
              type: object
            bootMACAddress:
              description: Which MAC address will PXE boot? This is optional for some
                types, but required for libvirt VMs driven by vbmc.
              pattern: '[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){5}'
              type: string
            consumerRef:
              description: ConsumerRef can be used to store information about something
                that is using a host. When it is not empty, the host is considered
                "in use".
              properties:
                apiVersion:
                  description: API version of the referent.
                  type: string
                fieldPath:
                  description: 'If referring to a piece of an object instead of an
                    entire object, this string should contain a valid JSON/Go field
                    access statement, such as desiredState.manifest.containers[2].
                    For example, if the object reference is to a container within
                    a pod, this would take on a value like: "spec.containers{name}"
                    (where "name" refers to the name of the container that triggered
                    the event) or if no container name is specified "spec.containers[2]"
                    (container with index 2 in this pod). This syntax is chosen only
                    to have some well-defined way of referencing a part of an object.
                    TODO: this design is not final and this field is subject to change
                    in the future.'
                  type: string
                kind:
                  description: 'Kind of the referent. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds'
                  type: string
                name:
                  description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                  type: string
                namespace:
                  description: 'Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/'
                  type: string
                resourceVersion:
                  description: 'Specific resourceVersion to which this reference is
                    made, if any. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#concurrency-control-and-consistency'
                  type: string
                uid:
                  description: 'UID of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids'
                  type: string
              type: object
            description:
              description: Description is a human-entered text used to help identify
                the host
              type: string
            externallyProvisioned:
              description: ExternallyProvisioned means something else is managing
                the image running on the host and the operator should only manage
                the power status and hardware inventory inspection. If the Image field
                is filled in, this field is ignored.
              type: boolean
            hardwareProfile:
              description: What is the name of the hardware profile for this host?
                It should only be necessary to set this when inspection cannot automatically
                determine the profile.
              type: string
            image:
              description: Image holds the details of the image to be provisioned.
              properties:
                checksum:
                  description: Checksum is the checksum for the image.
                  type: string
                url:
                  description: URL is a location of an image to deploy.
                  type: string
              required:
              - checksum
              - url
              type: object
            online:
              description: Should the server be online?
              type: boolean
            taints:
              description: Taints is the full, authoritative list of taints to apply
                to the corresponding Machine. This list will overwrite any modifications
                made to the Machine on an ongoing basis.
              items:
                description: The node this Taint is attached to has the "effect" on
                  any pod that does not tolerate the Taint.
                properties:
                  effect:
                    description: Required. The effect of the taint on pods that do
                      not tolerate the taint. Valid effects are NoSchedule, PreferNoSchedule
                      and NoExecute.
                    type: string
                  key:
                    description: Required. The taint key to be applied to a node.
                    type: string
                  timeAdded:
                    description: TimeAdded represents the time at which the taint
                      was added. It is only written for NoExecute taints.
                    format: date-time
                    type: string
                  value:
                    description: Required. The taint value corresponding to the taint
                      key.
                    type: string
                required:
                - effect
                - key
                type: object
              type: array
            userData:
              description: UserData holds the reference to the Secret containing the
                user data to be passed to the host before it boots.
              properties:
                name:
                  description: Name is unique within a namespace to reference a secret
                    resource.
                  type: string
                namespace:
                  description: Namespace defines the space within which the secret
                    name must be unique.
                  type: string
              type: object
          required:
          - online
          type: object
        status:
          description: BareMetalHostStatus defines the observed state of BareMetalHost
          properties:
            errorMessage:
              description: the last error message reported by the provisioning subsystem
              type: string
            goodCredentials:
              description: the last credentials we were able to validate as working
              properties:
                credentials:
                  description: SecretReference represents a Secret Reference. It has
                    enough information to retrieve secret in any namespace
                  properties:
                    name:
                      description: Name is unique within a namespace to reference
                        a secret resource.
                      type: string
                    namespace:
                      description: Namespace defines the space within which the secret
                        name must be unique.
                      type: string
                  type: object
                credentialsVersion:
                  type: string
              type: object
            hardware:
              description: The hardware discovered to exist on the host.
              properties:
                cpu:
                  description: CPU describes one processor on the host.
                  properties:
                    arch:
                      type: string
                    clockMegahertz:
                      description: ClockSpeed is a clock speed in MHz
                      format: int64
                      type: integer
                    count:
                      type: integer
                    flags:
                      items:
                        type: string
                      type: array
                    model:
                      type: string
                  required:
                  - arch
                  - clockMegahertz
                  - count
                  - flags
                  - model
                  type: object
                firmware:
                  description: Firmware describes the firmware on the host.
                  properties:
                    bios:
                      description: The BIOS for this firmware
                      properties:
                        date:
                          description: The release/build date for this BIOS
                          type: string
                        vendor:
                          description: The vendor name for this BIOS
                          type: string
                        version:
                          description: The version of the BIOS
                          type: string
                      required:
                      - date
                      - vendor
                      - version
                      type: object
                  required:
                  - bios
                  type: object
                hostname:
                  type: string
                nics:
                  items:
                    description: NIC describes one network interface on the host.
                    properties:
                      ip:
                        description: The IP address of the device
                        type: string
                      mac:
                        description: The device MAC addr
                        pattern: '[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){5}'
                        type: string
                      model:
                        description: The name of the model, e.g. "virt-io"
                        type: string
                      name:
                        description: The name of the NIC, e.g. "nic-1"
                        type: string
                      pxe:
                        description: Whether the NIC is PXE Bootable
                        type: boolean
                      speedGbps:
                        description: The speed of the device
                        type: integer
                      vlanId:
                        description: The untagged VLAN ID
                        format: int32
                        maximum: 4094
                        minimum: 0
                        type: integer
                      vlans:
                        description: The VLANs available
                        items:
                          description: VLAN represents the name and ID of a VLAN
                          properties:
                            id:
                              description: VLANID is a 12-bit 802.1Q VLAN identifier
                              format: int32
                              maximum: 4094
                              minimum: 0
                              type: integer
                            name:
                              type: string
                          required:
                          - id
                          type: object
                        type: array
                    required:
                    - ip
                    - mac
                    - model
                    - name
                    - pxe
                    - speedGbps
                    - vlanId
                    type: object
                  type: array
                ramMebibytes:
                  type: integer
                storage:
                  items:
                    description: Storage describes one storage device (disk, SSD,
                      etc.) on the host.
                    properties:
                      hctl:
                        description: The SCSI location of the device
                        type: string
                      model:
                        description: Hardware model
                        type: string
                      name:
                        description: A name for the disk, e.g. "disk 1 (boot)"
                        type: string
                      rotational:
                        description: Whether this disk represents rotational storage
                        type: boolean
                      serialNumber:
                        description: The serial number of the device
                        type: string
                      sizeBytes:
                        description: The size of the disk in Bytes
                        format: int64
                        type: integer
                      vendor:
                        description: The name of the vendor of the device
                        type: string
                      wwn:
                        description: The WWN of the device
                        type: string
                      wwnVendorExtension:
                        description: The WWN Vendor extension of the device
                        type: string
                      wwnWithExtension:
                        description: The WWN with the extension
                        type: string
                    required:
                    - name
                    - rotational
                    - serialNumber
                    - sizeBytes
                    type: object
                  type: array
                systemVendor:
                  description: HardwareSystemVendor stores details about the whole
                    hardware system.
                  properties:
                    manufacturer:
                      type: string
                    productName:
                      type: string
                    serialNumber:
                      type: string
                  required:
                  - manufacturer
                  - productName
                  - serialNumber
                  type: object
              required:
              - cpu
              - firmware
              - hostname
              - nics
              - ramMebibytes
              - storage
              - systemVendor
              type: object
            hardwareProfile:
              description: The name of the profile matching the hardware details.
              type: string
            lastUpdated:
              description: LastUpdated identifies when this status was last observed.
              format: date-time
              type: string
            operationalStatus:
              description: OperationalStatus holds the status of the host
              type: string
            poweredOn:
              description: indicator for whether or not the host is powered on
              type: boolean
            provisioning:
              description: Information tracked by the provisioner.
              properties:
                ID:
                  description: The machine's UUID from the underlying provisioning
                    tool
                  type: string
                image:
                  description: Image holds the details of the last image successfully
                    provisioned to the host.
                  properties:
                    checksum:
                      description: Checksum is the checksum for the image.
                      type: string
                    url:
                      description: URL is a location of an image to deploy.
                      type: string
                  required:
                  - checksum
                  - url
                  type: object
                state:
                  description: An indiciator for what the provisioner is doing with
                    the host.
                  type: string
              required:
              - ID
              - state
              type: object
            triedCredentials:
              description: the last credentials we sent to the provisioning backend
              properties:
                credentials:
                  description: SecretReference represents a Secret Reference. It has
                    enough information to retrieve secret in any namespace
                  properties:
                    name:
                      description: Name is unique within a namespace to reference
                        a secret resource.
                      type: string
                    namespace:
                      description: Namespace defines the space within which the secret
                        name must be unique.
                      type: string
                  type: object
                credentialsVersion:
                  type: string
              type: object
          required:
          - errorMessage
          - goodCredentials
          - hardwareProfile
          - operationalStatus
          - poweredOn
          - provisioning
          - triedCredentials
          type: object
      type: object
  version: v1alpha1
  versions:
  - name: v1alpha1
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  labels:
    control-plane: capbm-controller-manager
  name: baremetalmachines.infrastructure.cluster.x-k8s.io
spec:
  additionalPrinterColumns:
  - JSONPath: .spec.providerID
    description: Provider ID
    name: ProviderID
    type: string
  - JSONPath: .status.ready
    description: Machine is Ready
    name: Ready
    type: string
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: BareMetalMachine
    plural: baremetalmachines
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: BareMetalMachine is the Schema for the baremetalmachines API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: BareMetalMachineSpec defines the desired state of BareMetalMachine
          properties:
            hostSelector:
              description: HostSelector specifies matching criteria for labels on
                BareMetalHosts. This is used to limit the set of BareMetalHost objects
                considered for claiming for a Machine.
              properties:
                matchExpressions:
                  description: Label match expressions that must be true on a chosen
                    BareMetalHost
                  items:
                    properties:
                      key:
                        type: string
                      operator:
                        description: Operator represents a key/field's relationship
                          to value(s). See labels.Requirement and fields.Requirement
                          for more details.
                        type: string
                      values:
                        items:
                          type: string
                        type: array
                    required:
                    - key
                    - operator
                    - values
                    type: object
                  type: array
                matchLabels:
                  additionalProperties:
                    type: string
                  description: Key/value pairs of labels that must exist on a chosen
                    BareMetalHost
                  type: object
              type: object
            image:
              description: Image is the image to be provisioned.
              properties:
                checksum:
                  description: Checksum is a md5sum value or a URL to retrieve one.
                  type: string
                url:
                  description: URL is a location of an image to deploy.
                  type: string
              required:
              - checksum
              - url
              type: object
            providerID:
              description: ProviderID will be the baremetal machine in ProviderID
                format (baremetal:////<machinename>)
              type: string
            userData:
              description: UserData references the Secret that holds user data needed
                by the bare metal operator. The Namespace is optional; it will default
                to the Machine's namespace if not specified.
              properties:
                name:
                  description: Name is unique within a namespace to reference a secret
                    resource.
                  type: string
                namespace:
                  description: Namespace defines the space within which the secret
                    name must be unique.
                  type: string
              type: object
          required:
          - image
          type: object
        status:
          description: BareMetalMachineStatus defines the observed state of BareMetalMachine
          properties:
            addresses:
              description: Addresses is a list of addresses assigned to the machine.
                This field is copied from the infrastructure provider reference.
              items:
                description: MachineAddress contains information for the node's address.
                properties:
                  address:
                    description: The machine address.
                    type: string
                  type:
                    description: Machine address type, one of Hostname, ExternalIP
                      or InternalIP.
                    type: string
                required:
                - address
                - type
                type: object
              type: array
            bootstrapReady:
              description: BootstrapReady is the state of the bootstrap provider.
              type: boolean
            errorMessage:
              description: "ErrorMessage will be set in the event that there is a
                terminal problem reconciling the Machine and will contain a more verbose
                string suitable for logging and human consumption. \n This field should
                not be set for transitive errors that a controller faces that are
                expected to be fixed automatically over time (like service outages),
                but instead indicate that something is fundamentally wrong with the
                Machine's spec or the configuration of the controller, and that manual
                intervention is required. Examples of terminal errors would be invalid
                combinations of settings in the spec, values that are unsupported
                by the controller, or the responsible controller itself being critically
                misconfigured. \n Any transient errors that occur during the reconciliation
                of Machines can be added as events to the Machine object and/or logged
                in the controller's output."
              type: string
            errorReason:
              description: "ErrorReason will be set in the event that there is a terminal
                problem reconciling the Machine and will contain a succinct value
                suitable for machine interpretation. \n This field should not be set
                for transitive errors that a controller faces that are expected to
                be fixed automatically over time (like service outages), but instead
                indicate that something is fundamentally wrong with the Machine's
                spec or the configuration of the controller, and that manual intervention
                is required. Examples of terminal errors would be invalid combinations
                of settings in the spec, values that are unsupported by the controller,
                or the responsible controller itself being critically misconfigured.
                \n Any transient errors that occur during the reconciliation of Machines
                can be added as events to the Machine object and/or logged in the
                controller's output."
              type: string
            infrastructureReady:
              description: InfrastructureReady is the state of the infrastructure
                provider.
              type: boolean
            lastUpdated:
              description: LastUpdated identifies when this status was last observed.
              format: date-time
              type: string
            nodeRef:
              description: NodeRef will point to the corresponding Node if it exists.
              properties:
                apiVersion:
                  description: API version of the referent.
                  type: string
                fieldPath:
                  description: 'If referring to a piece of an object instead of an
                    entire object, this string should contain a valid JSON/Go field
                    access statement, such as desiredState.manifest.containers[2].
                    For example, if the object reference is to a container within
                    a pod, this would take on a value like: "spec.containers{name}"
                    (where "name" refers to the name of the container that triggered
                    the event) or if no container name is specified "spec.containers[2]"
                    (container with index 2 in this pod). This syntax is chosen only
                    to have some well-defined way of referencing a part of an object.
                    TODO: this design is not final and this field is subject to change
                    in the future.'
                  type: string
                kind:
                  description: 'Kind of the referent. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
                  type: string
                name:
                  description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                  type: string
                namespace:
                  description: 'Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/'
                  type: string
                resourceVersion:
                  description: 'Specific resourceVersion to which this reference is
                    made, if any. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency'
                  type: string
                uid:
                  description: 'UID of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids'
                  type: string
              type: object
            phase:
              description: Phase represents the current phase of machine actuation.
                E.g. Pending, Running, Terminating, Failed etc.
              type: string
            ready:
              description: 'Ready is the state of the metal3. TODO : Document the
                variable : mhrivnak: " it would be good to document what this means,
                how to interpret it, under what circumstances the value changes, etc."'
              type: boolean
            version:
              description: Version specifies the current version of Kubernetes running
                on the corresponding Node. This is meant to be a means of bubbling
                up status from the Node to the Machine. It is entirely optional, but
                useful for end-user UX if it’s present.
              type: string
          type: object
      type: object
  version: v1alpha2
  versions:
  - name: v1alpha2
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  labels:
    control-plane: capbm-controller-manager
  name: baremetalmachinetemplates.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: BareMetalMachineTemplate
    plural: baremetalmachinetemplates
  scope: Namespaced
  validation:
    openAPIV3Schema:
      description: BareMetalMachineTemplate is the Schema for the baremetalmachinetemplates
        API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: BareMetalMachineTemplateSpec defines the desired state of BareMetalMachineTemplate
          properties:
            template:
              description: BareMetalMachineTemplateResource describes the data needed
                to create a BareMetalMachine from a template
              properties:
                spec:
                  description: Spec is the specification of the desired behavior of
                    the machine.
                  properties:
                    hostSelector:
                      description: HostSelector specifies matching criteria for labels
                        on BareMetalHosts. This is used to limit the set of BareMetalHost
                        objects considered for claiming for a Machine.
                      properties:
                        matchExpressions:
                          description: Label match expressions that must be true on
                            a chosen BareMetalHost
                          items:
                            properties:
                              key:
                                type: string
                              operator:
                                description: Operator represents a key/field's relationship
                                  to value(s). See labels.Requirement and fields.Requirement
                                  for more details.
                                type: string
                              values:
                                items:
                                  type: string
                                type: array
                            required:
                            - key
                            - operator
                            - values
                            type: object
                          type: array
                        matchLabels:
                          additionalProperties:
                            type: string
                          description: Key/value pairs of labels that must exist on
                            a chosen BareMetalHost
                          type: object
                      type: object
                    image:
                      description: Image is the image to be provisioned.
                      properties:
                        checksum:
                          description: Checksum is a md5sum value or a URL to retrieve
                            one.
                          type: string
                        url:
                          description: URL is a location of an image to deploy.
                          type: string
                      required:
                      - checksum
                      - url
                      type: object
                    providerID:
                      description: ProviderID will be the baremetal machine in ProviderID
                        format (baremetal:////<machinename>)
                      type: string
                    userData:
                      description: UserData references the Secret that holds user
                        data needed by the bare metal operator. The Namespace is optional;
                        it will default to the Machine's namespace if not specified.
                      properties:
                        name:
                          description: Name is unique within a namespace to reference
                            a secret resource.
                          type: string
                        namespace:
                          description: Namespace defines the space within which the
                            secret name must be unique.
                          type: string
                      type: object
                  required:
                  - image
                  type: object
              required:
              - spec
              type: object
          required:
          - template
          type: object
      type: object
  version: v1alpha2
  versions:
  - name: v1alpha2
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-leader-election-role
  namespace: capbm-system
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps/status
  verbs:
  - get
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  creationTimestamp: null
  labels:
    control-plane: capbm-controller-manager
  name: capbm-manager-role
rules:
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cluster.x-k8s.io
  resources:
  - clusters
  - clusters/status
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - cluster.x-k8s.io
  resources:
  - machines
  - machines/status
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - baremetalclusters
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - baremetalclusters/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - baremetalmachines
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - baremetalmachines/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - metal3.io
  resources:
  - baremetalhosts
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - metal3.io
  resources:
  - baremetalhosts/status
  verbs:
  - get
  - patch
  - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-proxy-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-leader-election-rolebinding
  namespace: capbm-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: capbm-leader-election-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capbm-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: capbm-manager-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capbm-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-proxy-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: capbm-proxy-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capbm-system
---
apiVersion: v1
data:
  credentials: QVdTX0I2NEVOQ09ERURfQ1JFREVOVElBTFM=
kind: Secret
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-manager-bootstrap-credentials
  namespace: capbm-system
type: Opaque
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    control-plane: capbm-controller-manager
  name: capbm-webhook-server-secret
  namespace: capbm-system
---
apiVersion: v1
kind: Service
metadata:
  labels:
    control-plane: capbm-controller-manager
    controller-tools.k8s.io: "1.0"
  name: capbm-controller-manager-service
  namespace: capbm-system
spec:
  ports:
  - port: 443
  selector:
    control-plane: capbm-controller-manager
    controller-tools.k8s.io: "1.0"
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/port: "8443"
    prometheus.io/scheme: https
    prometheus.io/scrape: "true"
  labels:
    control-plane: capbm-controller-manager
  name: capbm-controller-metrics-service
  namespace: capbm-system
spec:
  ports:
  - name: https
    port: 8443
    targetPort: https
  selector:
    control-plane: capbm-controller-manager
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    control-plane: capbm-controller-manager
    controller-tools.k8s.io: "1.0"
  name: capbm-controller-manager
  namespace: capbm-system
spec:
  selector:
    matchLabels:
      control-plane: capbm-controller-manager
      controller-tools.k8s.io: "1.0"
  template:
    metadata:
      labels:
        control-plane: capbm-controller-manager
        controller-tools.k8s.io: "1.0"
    spec:
      containers:
      - args:
        - --secure-listen-address=0.0.0.0:8443
        - --upstream=http://127.0.0.1:8080/
        - --logtostderr=true
        - --v=10
        image: gcr.io/kubebuilder/kube-rbac-proxy:v0.4.0
        name: kube-rbac-proxy
        ports:
        - containerPort: 8443
          name: https
      - args:
        - --metrics-addr=127.0.0.1:8080
        - --enable-leader-election
        command:
        - /manager
        env:
        - name: BAREMETAL_SHARED_CREDENTIALS_FILE
          value: /home/.baremetal/credentials
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: SECRET_NAME
          value: $(WEBHOOK_SECRET_NAME)
        image: keleustes/cluster-api-baremetal-controller-amd64:dev
        imagePullPolicy: IfNotPresent
        name: manager
        ports:
        - containerPort: 9876
          name: webhook-server
          protocol: TCP
        resources:
          limits:
            cpu: 100m
            memory: 30Mi
          requests:
            cpu: 100m
            memory: 20Mi
        volumeMounts:
        - mountPath: /home/.baremetal
          name: credentials
        - mountPath: /tmp/cert
          name: cert
          readOnly: true
      terminationGracePeriodSeconds: 10
      volumes:
      - name: credentials
        secret:
          secretName: capbm-manager-bootstrap-credentials
      - name: cert
        secret:
          defaultMode: 420
          secretName: capbm-webhook-server-secret
